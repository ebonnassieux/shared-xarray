# this replicates the tests in sharedarray dev repo
import numpy.testing as npt
import numpy as np
import SharedArray as sa

# clean up in case previous testing was done only partly
sa.delete("test")

def test_sharedarray():

    # Create an array in shared memory.
    a = sa.create("shm://test", 10)
    
    # Attach it as a different array. This can be done from another
    # python interpreter as long as it runs on the same computer.
    b = sa.attach("shm://test")
    
    # See how they are actually sharing the same memory.
    a[0] = 42
    npt.assert_array_equal(a,b)

    # Destroying a does not affect b.
    del a
    npt.assert_equal(b[0],42)
